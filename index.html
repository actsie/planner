<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Calm - Your Gentle Digital Planner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Daily Calm</h1>
            <p class="quote" id="quoteDisplay"></p>
        </header>

        <div class="date-strip-wrapper">
            <div id="monthLabel" class="month-label">Month ‚ñæ</div>
            <div id="dateStrip" class="date-strip"></div>
            <div id="monthDropdown" class="month-dropdown"></div>
        </div>

        <div class="main-content">
            <div class="card" id="tasksCard">
                <div class="tabs">
                    <div class="tab active" id="tasksTabBtn">Today's Tasks</div>
                    <div class="tab" id="templateTabBtn">Task Templates</div>
                    <div class="tab" id="doneTabBtn">Done</div>
                </div>
                <div id="tasksTab" class="tab-content active">
                    <div class="todo-input-container">
                        <input type="text" id="taskInput" placeholder="What would you like to do today?" />
                        <button id="addTask">Add</button>
                    </div>
                    <ul id="taskList"></ul>
                </div>
                <div id="templateTab" class="tab-content">
                    <div class="templates-actions">
                        <button id="addTemplateBtn">New Template</button>
                    </div>
                    <input type="text" id="templateFilter" class="input-filter">
                    <ul id="templateList"></ul>
                    <button id="addToTodayBtn" class="add-to-today-btn hidden mt-05">
                        <span class="circle" aria-hidden="true">
                            <span class="icon arrow"></span>
                        </span>
                        <span class="button-text">Add Task</span>
                    </button>
                    <div id="templateToast" class="template-toast floating-msg hidden mt-05"></div>
                </div>
                <div id="doneTab" class="tab-content">
                    <ul id="doneTaskList"></ul>
                    <div class="trend-links-container" id="dailyReportContainer">
                        <div class="trend-wrapper">
                            <span id="viewDailyReport" class="trend-link">Daily Report</span>
                            <div id="dailyReportTooltip" class="trend-tooltip">
                                <div id="dailyReportContent" class="mood-trends"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="taskInfoCard" class="task-info-card"></div>
            </div>

            <div class="card">
                <h2>How are you feeling?</h2>
                <div class="mood-container" id="mainMoodContainer">
                    <div>
                        <div class="emoji" data-mood="üòê">üòê</div>
                        <div class="mood-label">meh</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üôÇ">üôÇ</div>
                        <div class="mood-label">okay</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üòÑ">üòÑ</div>
                        <div class="mood-label">good</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üòÆ‚Äçüí®">üòÆ‚Äçüí®</div>
                        <div class="mood-label">tired</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üò´">üò´</div>
                        <div class="mood-label">stressed</div>
                    </div>
                </div>
                <div class="mood-history" id="moodHistory"></div>
                <div class="mood-timeline" id="moodTimeline"></div>
                <div class="mood-actions">
                    <button id="toggleMoodLog" class="link-button hidden">View all</button>
                    <div class="trend-links-container">
                        <div class="trend-wrapper">
                            <span id="toggleTrendView" class="trend-link">View Trends</span>
                            <div id="trendTooltip" class="trend-tooltip">
                                <div id="moodTrends" class="mood-trends"></div>
                            </div>
                        </div>
                        <div class="trend-wrapper">
                            <span id="toggleEnergyView" class="trend-link">Energy Insights</span>
                            <div id="energyTooltip" class="trend-tooltip">
                                <div id="energyInsights" class="mood-trends"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" id="moodGaugeCard">
                <h2>Mood Fuel Gauge üö¶</h2>
                <div class="mood-gauge">
                    <div class="gauge-bar">
                        <div class="gauge-needle" id="moodGaugeNeedle">
                            <div class="gauge-needle-line"></div>
                            <div class="needle-label" id="moodGaugeLabel"></div>
                        </div>
                    </div>
                    <div class="gauge-labels">
                        <span>üò©</span>
                        <span>üòê</span>
                        <span>üôÇ</span>
                        <span>üòÑ</span>
                    </div>
                    <button id="openPastMoodsBtn" class="link-button mt-05">üìÖ View Past Moods</button>
                </div>
            </div>

            <div class="card" id="timerSection">
                <h2>Focus Timer</h2>
                <div id="floatingMsg" class="floating-msg hidden">Active timer is running elsewhere (see top-right)</div>
                <div id="minimizedTaskTimer" class="minimized-task-timer">
                    <div>
                        <span id="minTaskTitle"></span>
                        <span id="minTaskTime"></span>
                    </div>
                    <div class="task-progress"><div class="task-progress-bar" id="minTaskProgressBar"></div></div>
                    <div class="timer-controls">
                        <button onclick="pauseTaskTimer()" id="minPauseBtn">‚è∏Ô∏è</button>
                        <button onclick="resumeTaskTimer()" id="minResumeBtn" class="hidden">‚ñ∂Ô∏è</button>
                        <button onclick="completeCurrentTask()" title="Complete">‚úì</button>
                        <button onclick="cancelTaskTimer()">‚úñÔ∏è</button>
                        <button onclick="addMoreTimeDuringRun()">‚ûï</button>
                        <button onclick="maximizeTaskTimer()">üîº</button>
                    </div>
                </div>
                <div class="timer-display" id="timerArea">
                    <span id="timerDisplay">25:00</span>
                    <input id="timerInput" class="timer-input hidden" type="number" min="1" value="25">
                </div>
                <div class="timer-controls" id="focusTimerControls">
                    <button class="timer-btn" id="startTimer">Start</button>
                    <button class="timer-btn" id="pauseTimer" disabled>Pause</button>
                    <button class="timer-btn" id="resetTimer">Reset</button>
                </div>
                <div class="timer-progress">
                    <div class="timer-progress-bar" id="timerProgressBar"></div>
                </div>
            </div>

            <div class="notes-section">
                <div class="notes-sidebar">
                    <h3>My Notes</h3>
                    <button class="add-note-btn" id="addNoteBtn">+ Add Note</button>
                    <div class="notes-list" id="notesList"></div>
                </div>
                <div class="notes-main">
                    <div id="noteEditor" class="note-editor hidden">
                        <input type="text" class="note-title-input" id="noteTitleInput" placeholder="Note Title" />
                        <div class="note-content" id="noteContent" contenteditable="true" data-placeholder="Start writing your thoughts..."></div>
                        <div id="formatToolbar" class="format-toolbar hidden">
                            <button data-tag="strong">B</button>
                            <button data-tag="em">I</button>
                            <button data-tag="u">U</button>
                        </div>
                    </div>
                    <div id="emptyState" class="empty-state">
                        <p>Select a note to view or create a new one</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Timer Duration Modal -->
    <div class="modal unified-modal" id="durationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDurationModal()">‚ùå</button>
            <h3>Select Timer Duration</h3>
            <div class="duration-options">
                <button class="duration-btn" onclick="selectDuration(5)">5 minutes</button>
                <button class="duration-btn" onclick="selectDuration(10)">10 minutes</button>
                <button class="duration-btn" onclick="selectDuration(25)">25 minutes</button>
            </div>
            <div class="custom-duration">
                <input type="number" id="customDuration" placeholder="Custom minutes" min="1" max="60">
                <button class="modal-btn primary" onclick="selectCustomDuration()">Start</button>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeDurationModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Time Modal -->
    <div class="modal unified-modal" id="addTimeModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAddTimeModal()">‚ùå</button>
            <h3>Add more time</h3>
            <input type="number" id="addTimeInput" placeholder="Add how many minutes?" value="5" min="1" class="input-block">
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn secondary" onclick="closeAddTimeModal()">Cancel</button>
                <button class="modal-btn primary" id="confirmAddTime">Add</button>
            </div>
        </div>
    </div>

    <!-- Add Break Task Modal -->
    <div class="modal unified-modal" id="addBreakTaskModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeBreakTaskModal()">‚ùå</button>
            <h3>üß© Broken Down Tasks</h3>
            <p class="floating-msg">Add small sub-tasks so you know exactly where to pick up when you‚Äôre back.</p>
            <input type="text" id="breakTaskInput" placeholder="e.g., write intro paragraph" class="input-block">
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" onclick="saveBreakTask()">Add</button>
                <button class="modal-btn secondary" onclick="closeBreakTaskModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Subtask Modal -->
    <div class="modal unified-modal" id="addSubtaskModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeSubtaskModal()">‚ùå</button>
            <h3 id="subtaskModalTitle">Add Subtask</h3>
            <p class="floating-msg">Break this task into smaller steps</p>
            <div id="subtaskInputs" class="mt-1"></div>
            <button id="addSubtaskRowBtn" class="add-break-item">‚ûï Add subtask</button>
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" onclick="saveSubtasks()">Save</button>
                <button class="modal-btn secondary" onclick="closeSubtaskModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- New Template Modal -->
    <div class="modal unified-modal" id="templateModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeTemplateModal()">‚ùå</button>
            <h3 id="templateModalTitle">New Template</h3>
            <input type="text" id="templateNameInput" placeholder="Template name" class="input-block">
            <div id="templateSubtasks" class="mt-1"></div>
            <button id="addSubtaskBtn" class="add-break-item">‚ûï Add subtask</button>
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" onclick="saveTemplate()">Save</button>
                <button class="modal-btn secondary" onclick="closeTemplateModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Delete Template Modal -->
    <div class="modal unified-modal" id="deleteTemplateModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDeleteTemplateModal()">‚ùå</button>
            <h3>Delete this template?</h3>
            <p class="mt-05">This cannot be undone.</p>
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" onclick="confirmDeleteTemplate()">Delete</button>
                <button class="modal-btn secondary" onclick="closeDeleteTemplateModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Task Completion Modal -->
    <div class="modal unified-modal" id="completionModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeCompletionModal()">‚ùå</button>
            <h3>Timer Complete! Did you finish this task?</h3>
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="completeTask()">‚úÖ Yes, finished</button>
                <button class="modal-btn secondary" onclick="addMoreTime()">‚ûï Need more time</button>
                <button class="modal-btn secondary" onclick="keepTaskActive()">üïó Keep working</button>
            </div>
        </div>
    </div>

    <!-- Daily Log Modal -->
    <div class="modal unified-modal" id="dailyLogModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDailyLog()">‚ùå</button>
            <h3>Daily Log</h3>
            <div id="dailyLogContent"></div>
        </div>
    </div>

    <!-- Mood Reason Modal -->
    <div class="modal unified-modal" id="moodReasonModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeMoodReasonModal()">‚ùå</button>
            <h3 id="moodReasonHeader">Want to share why you felt this way?</h3>
            <input type="text" id="moodReasonInput" class="modal-input" placeholder="Optional reason">
            <div id="breakSuggestion" class="hidden">
                <p class="mb-05">üí¨ Sounds like it might be time for a break. Want to try breaking your task down first?</p>
                <div id="breakSteps" class="break-steps-container">
                    <div class="break-item"><input type="checkbox"><input type="text" class="break-input" placeholder="e.g., write intro paragraph"></div>
                    <div class="break-item"><input type="checkbox"><input type="text" class="break-input" placeholder="e.g., add tweet image"></div>
                    <div class="break-item"><input type="checkbox"><input type="text" class="break-input" placeholder="break task 3‚Ä¶"></div>
                </div>
                <button id="addBreakStep" class="add-break-item">‚ûï Add</button>
                <div class="break-duration-section">
                    <span class="break-duration-text">Break time:</span>
                    <input type="number" id="breakDuration" value="15" min="1" class="width-60">
                    <span>min</span>
                    <button class="modal-btn primary" id="startBreakBtn">Start Break</button>
                </div>
                <div id="breakError" class="break-error"></div>
            </div>
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" id="saveMoodReason" title="Save without starting break">Save Tasks</button>
                <button class="modal-btn secondary" id="skipMoodReason" title="Skip without saving anything">Skip</button>
            </div>
        </div>
    </div>

    <!-- Focus Task Name Modal -->
    <div class="modal unified-modal" id="focusTaskModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeFocusTaskModal()">‚ùå</button>
            <h3>Name this focus session</h3>
            <input type="text" id="focusTaskName" placeholder="Task name" class="input-block">
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" id="startFocusTask">Start</button>
                <button class="modal-btn secondary" onclick="closeFocusTaskModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Mood Prompt Modal -->
    <div class="modal unified-modal" id="moodPromptModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeMoodPromptModal()">‚ùå</button>
            <h3 id="moodPromptTitle">Mood Check</h3>
            <div class="mood-container">
                <div>
                    <div class="emoji" data-mood="üòê">üòê</div>
                    <div class="mood-label">meh</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üôÇ">üôÇ</div>
                    <div class="mood-label">okay</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üòÑ">üòÑ</div>
                    <div class="mood-label">good</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üòÆ‚Äçüí®">üòÆ‚Äçüí®</div>
                    <div class="mood-label">tired</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üò´">üò´</div>
                    <div class="mood-label">stressed</div>
                </div>
            </div>
                <input type="text" id="moodPromptReason" placeholder="What made it difficult?" class="input-block hidden">
            <div class="modal-actions" class="mt-15">
                <button class="modal-btn primary" id="submitMoodPrompt" class="hidden">Submit</button>
            </div>
        </div>
    </div>

    <!-- Task Timer Display -->
    <div class="task-timer-display" id="taskTimerDisplay" class="hidden">
        <button class="minimize-btn" onclick="minimizeTaskTimer()">‚ñæ</button>
        <div class="task-timer-title" id="taskTimerTitle"></div>
        <div class="task-timer-time" id="taskTimerTime"></div>
        <div class="task-progress"><div class="task-progress-bar" id="taskProgressBar"></div></div>
        <div class="timer-controls">
            <button onclick="pauseTaskTimer()" id="pauseTaskBtn">‚è∏</button>
            <button onclick="resumeTaskTimer()" id="resumeTaskBtn" class="hidden">‚ñ∂Ô∏è</button>
            <button onclick="completeCurrentTask()" title="Mark as complete">‚úì</button>
            <button onclick="addMoreTimeDuringRun()">‚ûï</button>
            <button onclick="cancelTaskTimer()">‚úñÔ∏è</button>
        </div>
    </div>

    <div class="task-timer-display" id="breakTimerDisplay" class="hidden bg-break">
        <button class="minimize-btn" onclick="cancelBreakTimer()">‚úñÔ∏è</button>
        <div class="task-timer-title">Break Time ‚òïÔ∏è</div>
        <div class="task-timer-time" id="breakTimerTime"></div>
        <div class="task-progress"><div class="task-progress-bar" id="breakProgressBar"></div></div>
    </div>

    <!-- Past Moods Modal -->
    <div class="modal unified-modal" id="pastMoodsModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closePastMoodsModal()">‚ùå</button>
            <h3>Past Moods</h3>
            <div id="pastMoodsContent" class="mood-timeline"></div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>
</html>
