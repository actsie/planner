<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Calm - Your Gentle Digital Planner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Daily Calm</h1>
            <p class="quote" id="quoteDisplay"></p>
        </header>

        <div class="date-strip-wrapper">
            <div id="monthLabel" class="month-label">Month ‚ñæ</div>
            <div id="dateStrip" class="date-strip"></div>
            <div id="monthDropdown" class="month-dropdown"></div>
        </div>

        <div class="main-content">
            <div class="card" id="tasksCard">
                <div class="tabs">
                    <div class="tab active" id="tasksTabBtn">Today's Tasks</div>
                    <div class="tab" id="templateTabBtn">Task Templates</div>
                    <div class="tab" id="doneTabBtn">Done</div>
                </div>
                <div id="tasksTab" class="tab-content active">
                    <div class="todo-input-container">
                        <input type="text" id="taskInput" placeholder="What would you like to do today?" />
                        <button id="addTask">Add</button>
                    </div>
                    <ul id="taskList"></ul>
                </div>
                <div id="templateTab" class="tab-content">
                    <div class="templates-actions">
                        <button id="addTemplateBtn">New Template</button>
                    </div>
                    <input type="text" id="templateFilter" placeholder="Filter templates" class="template-filter">
                    <ul id="templateList"></ul>
                    <button id="addToTodayBtn" class="add-to-today-btn add-to-today-btn-hidden">
                        <span class="circle" aria-hidden="true">
                            <span class="icon arrow"></span>
                        </span>
                        <span class="button-text">Add Task</span>
                    </button>
                    <div id="templateToast" class="template-toast floating-msg template-toast-hidden"></div>
                </div>
                <div id="doneTab" class="tab-content">
                    <ul id="doneTaskList"></ul>
                    <div class="trend-links-container" id="dailyReportContainer">
                        <div class="trend-wrapper">
                            <span id="viewDailyReport" class="trend-link">Daily Report</span>
                            <div id="dailyReportTooltip" class="trend-tooltip">
                                <div id="dailyReportContent" class="mood-trends"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="taskInfoCard" class="task-info-card"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>How are you feeling?</h2>
                    <button class="mood-help-btn" id="moodHelpBtn" title="Why track your mood?">?</button>
                </div>
                <div class="mood-container" id="mainMoodContainer">
                    <div>
                        <div class="emoji" data-mood="üòê">üòê</div>
                        <div class="mood-label">meh</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üôÇ">üôÇ</div>
                        <div class="mood-label">okay</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üòÑ">üòÑ</div>
                        <div class="mood-label">good</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üòÆ‚Äçüí®">üòÆ‚Äçüí®</div>
                        <div class="mood-label">tired</div>
                    </div>
                    <div>
                        <div class="emoji" data-mood="üò´">üò´</div>
                        <div class="mood-label">stressed</div>
                    </div>
                </div>
                
                <!-- Integrated Battery Mood Gauge -->
                <div class="mood-battery">
                    <div class="today-energy-label" id="todayEnergyLabel">Today's energy</div>
                    <div class="battery-container">
                        <div class="battery-gauge">
                            <div class="battery-body">
                                <div class="battery-bar" data-bar="1"></div>
                                <div class="battery-bar" data-bar="2"></div>
                                <div class="battery-bar" data-bar="3"></div>
                                <div class="battery-bar" data-bar="4"></div>
                                <div class="battery-bar" data-bar="5"></div>
                            </div>
                            <div class="battery-tip"></div>
                        </div>
                    </div>
                    <div class="mood-context-message" id="moodContextMessage">Select your mood to see your energy</div>
                </div>
                
                <div class="mood-history" id="moodHistory"></div>
                <div class="mood-timeline" id="moodTimeline"></div>
                <div class="mood-actions">
                    <button id="openPastMoodsBtn" class="link-button">View Past Moods</button>
                    <div class="trend-links-container">
                        <div class="trend-wrapper">
                            <span id="toggleTrendView" class="trend-link">View Trends</span>
                            <div id="trendTooltip" class="trend-tooltip">
                                <div id="moodTrends" class="mood-trends"></div>
                            </div>
                        </div>
                        <div class="trend-wrapper">
                            <span id="toggleEnergyView" class="trend-link">Energy Insights</span>
                            <div id="energyTooltip" class="trend-tooltip">
                                <div id="energyInsights" class="mood-trends"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="card" id="timerSection">
                <h2>Focus Timer</h2>
                <div id="floatingMsg" class="floating-msg floating-msg-hidden">Active timer is running elsewhere (see top-right)</div>
                <div id="minimizedTaskTimer" class="minimized-task-timer">
                    <div>
                        <span id="minTaskTitle"></span>
                        <span id="minTaskTime"></span>
                    </div>
                    <div class="task-progress"><div class="task-progress-bar" id="minTaskProgressBar"></div></div>
                    <div class="timer-controls">
                        <button onclick="pauseTaskTimer()" id="minPauseBtn">‚è∏Ô∏è</button>
                        <button onclick="resumeTaskTimer()" id="minResumeBtn" class="timer-resume-btn-hidden">‚ñ∂Ô∏è</button>
                        <button onclick="completeCurrentTask()" title="Complete">‚úì</button>
                        <button onclick="cancelTaskTimer()">‚úñÔ∏è</button>
                        <button onclick="addMoreTimeDuringRun()">‚ûï</button>
                        <button onclick="maximizeTaskTimer()">üîº</button>
                    </div>
                </div>
                <div class="timer-display" id="timerArea">
                    <span id="timerDisplay">25:00</span>
                    <input id="timerInput" class="timer-input timer-input-hidden" type="number" min="1" value="25">
                </div>
                <div class="timer-controls" id="focusTimerControls">
                    <button class="timer-btn" id="startTimer">Start</button>
                    <button class="timer-btn" id="pauseTimer" disabled>Pause</button>
                    <button class="timer-btn" id="resetTimer">Reset</button>
                </div>
                <div class="timer-progress">
                    <div class="timer-progress-bar" id="timerProgressBar"></div>
                </div>
            </div>

            <div class="notes-section">
                <div class="notes-sidebar">
                    <h3>My Notes</h3>
                    <button class="add-note-btn" id="addNoteBtn">+ Add Note</button>
                    <div class="notes-list" id="notesList"></div>
                </div>
                <div class="notes-main">
                    <div id="noteEditor" class="note-editor note-editor-hidden">
                        <input type="text" class="note-title-input" id="noteTitleInput" placeholder="Note Title" />
                        <div class="note-content" id="noteContent" contenteditable="true" data-placeholder="Start writing your thoughts..."></div>
                        <div id="formatToolbar" class="format-toolbar format-toolbar-hidden">
                            <button data-tag="strong">B</button>
                            <button data-tag="em">I</button>
                            <button data-tag="u">U</button>
                        </div>
                    </div>
                    <div id="emptyState" class="empty-state">
                        <p>Select a note to view or create a new one</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Timer Duration Modal -->
    <div class="modal unified-modal" id="durationModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDurationModal()">‚ùå</button>
            <h3>Select Timer Duration</h3>
            <div class="duration-options">
                <button class="duration-btn" onclick="selectDuration(5)">5 minutes</button>
                <button class="duration-btn" onclick="selectDuration(10)">10 minutes</button>
                <button class="duration-btn" onclick="selectDuration(25)">25 minutes</button>
            </div>
            <div class="custom-duration">
                <input type="number" id="customDuration" placeholder="Custom minutes" min="1" max="60">
                <button class="modal-btn primary" onclick="selectCustomDuration()">Start</button>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeDurationModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Time Modal -->
    <div class="modal unified-modal" id="addTimeModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAddTimeModal()">‚ùå</button>
            <h3>Add more time</h3>
            <input type="number" id="addTimeInput" placeholder="Add how many minutes?" value="5" min="1" class="modal-input">
            <div class="modal-actions">
                <button class="modal-btn secondary" onclick="closeAddTimeModal()">Cancel</button>
                <button class="modal-btn primary" id="confirmAddTime">Add</button>
            </div>
        </div>
    </div>

    <!-- Add Break Task Modal -->
    <div class="modal unified-modal" id="addBreakTaskModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeBreakTaskModal()">‚ùå</button>
            <h3>üß© Broken Down Tasks</h3>
            <p class="floating-msg">Add small sub-tasks so you know exactly where to pick up when you're back.</p>
            <input type="text" id="breakTaskInput" placeholder="e.g., write intro paragraph" class="modal-input">
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="saveBreakTask()">Add</button>
                <button class="modal-btn secondary" onclick="closeBreakTaskModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add Subtask Modal -->
    <div class="modal unified-modal" id="addSubtaskModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeSubtaskModal()">‚ùå</button>
            <h3 id="subtaskModalTitle">Add Subtask</h3>
            <p class="floating-msg">Break this task into smaller steps</p>
            <div id="subtaskInputs"></div>
            <button id="addSubtaskRowBtn" class="add-break-item">‚ûï Add subtask</button>
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="saveSubtasks()">Save</button>
                <button class="modal-btn secondary" onclick="closeSubtaskModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- New Template Modal -->
    <div class="modal unified-modal" id="templateModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeTemplateModal()">‚ùå</button>
            <h3 id="templateModalTitle">New Template</h3>
            <input type="text" id="templateNameInput" placeholder="Template name" class="modal-input">
            <div id="templateSubtasks"></div>
            <button id="addSubtaskBtn" class="add-break-item">‚ûï Add subtask</button>
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="saveTemplate()">Save</button>
                <button class="modal-btn secondary" onclick="closeTemplateModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Delete Template Modal -->
    <div class="modal unified-modal" id="deleteTemplateModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDeleteTemplateModal()">‚ùå</button>
            <h3>Delete this template?</h3>
            <p>This cannot be undone.</p>
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="confirmDeleteTemplate()">Delete</button>
                <button class="modal-btn secondary" onclick="closeDeleteTemplateModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Task Completion Modal -->
    <div class="modal unified-modal" id="completionModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeCompletionModal()">‚ùå</button>
            <h3>Timer Complete! Did you finish this task?</h3>
            <div class="modal-actions">
                <button class="modal-btn primary" onclick="completeTask()">‚úÖ Yes, finished</button>
                <button class="modal-btn secondary" onclick="addMoreTime()">‚ûï Need more time</button>
                <button class="modal-btn secondary" onclick="keepTaskActive()">üïó Keep working</button>
            </div>
        </div>
    </div>

    <!-- Daily Log Modal -->
    <div class="modal unified-modal" id="dailyLogModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeDailyLog()">‚ùå</button>
            <h3>Daily Log</h3>
            <div id="dailyLogContent"></div>
        </div>
    </div>

    <!-- Mood Reason Modal -->
    <div class="modal unified-modal" id="moodReasonModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeMoodReasonModal()">‚ùå</button>
            <h3 id="moodReasonHeader">Want to share why you felt this way?</h3>
            <input type="text" id="moodReasonInput" class="modal-input" placeholder="Optional reason">
            <div id="breakSuggestion">
                <p>üí¨ Sounds like it might be time for a break. Want to try breaking your task down first?</p>
                <div id="breakSteps" class="break-steps-container">
                    <div class="break-item"><input type="checkbox"><input type="text" class="break-input" placeholder="e.g., write intro paragraph"></div>
                    <div class="break-item"><input type="checkbox"><input type="text" class="break-input" placeholder="e.g., add tweet image"></div>
                    <div class="break-item"><input type="checkbox"><input type="text" class="break-input" placeholder="break task 3‚Ä¶"></div>
                </div>
                <button id="addBreakStep" class="add-break-item">‚ûï Add</button>
                <div class="break-duration-section">
                    <span class="break-duration-text">Break time:</span>
                    <input type="number" id="breakDuration" value="15" min="1">
                    <span>min</span>
                    <button class="modal-btn primary" id="startBreakBtn">Start Break</button>
                </div>
                <div id="breakError" class="break-error"></div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn primary" id="saveMoodReason" title="Save without starting break">Save Tasks</button>
                <button class="modal-btn secondary" id="skipMoodReason" title="Skip without saving anything">Skip</button>
            </div>
        </div>
    </div>

    <!-- Focus Task Name Modal -->
    <div class="modal unified-modal" id="focusTaskModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeFocusTaskModal()">‚ùå</button>
            <h3>Name this focus session</h3>
            <input type="text" id="focusTaskName" placeholder="Task name" class="modal-input">
            <div class="modal-actions">
                <button class="modal-btn primary" id="startFocusTask">Start</button>
                <button class="modal-btn secondary" onclick="closeFocusTaskModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Mood Prompt Modal -->
    <div class="modal unified-modal" id="moodPromptModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeMoodPromptModal()">‚ùå</button>
            <h3 id="moodPromptTitle">Mood Check</h3>
            <div class="mood-container">
                <div>
                    <div class="emoji" data-mood="üòê">üòê</div>
                    <div class="mood-label">meh</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üôÇ">üôÇ</div>
                    <div class="mood-label">okay</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üòÑ">üòÑ</div>
                    <div class="mood-label">good</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üòÆ‚Äçüí®">üòÆ‚Äçüí®</div>
                    <div class="mood-label">tired</div>
                </div>
                <div>
                    <div class="emoji" data-mood="üò´">üò´</div>
                    <div class="mood-label">stressed</div>
                </div>
            </div>
                <input type="text" id="moodPromptReason" placeholder="What made it difficult?" class="modal-input mood-prompt-reason-hidden">
            <div class="modal-actions">
                <button class="modal-btn primary" id="submitMoodPrompt" class="submit-mood-prompt-hidden">Submit</button>
            </div>
        </div>
    </div>

    <!-- Task Timer Display -->
    <div class="task-timer-display task-timer-display-hidden" id="taskTimerDisplay">
        <button class="minimize-btn" onclick="minimizeTaskTimer()">‚ñæ</button>
        <div class="task-timer-title" id="taskTimerTitle"></div>
        <div class="task-timer-time" id="taskTimerTime"></div>
        <div class="task-progress"><div class="task-progress-bar" id="taskProgressBar"></div></div>
        <div class="timer-controls">
            <button onclick="pauseTaskTimer()" id="pauseTaskBtn">‚è∏</button>
            <button onclick="resumeTaskTimer()" id="resumeTaskBtn" class="timer-resume-btn-hidden">‚ñ∂Ô∏è</button>
            <button onclick="completeCurrentTask()" title="Mark as complete">‚úì</button>
            <button onclick="addMoreTimeDuringRun()">‚ûï</button>
            <button onclick="cancelTaskTimer()">‚úñÔ∏è</button>
        </div>
    </div>

    <div class="task-timer-display break-timer-display-hidden" id="breakTimerDisplay">
        <button class="minimize-btn" onclick="cancelBreakTimer()">‚úñÔ∏è</button>
        <div class="task-timer-title">Break Time ‚òïÔ∏è</div>
        <div class="task-timer-time" id="breakTimerTime"></div>
        <div class="task-progress"><div class="task-progress-bar" id="breakProgressBar"></div></div>
    </div>

    <!-- Mood Help Modal -->
    <div class="modal unified-modal" id="moodHelpModal">
        <div class="modal-content mood-help-content">
            <button class="modal-close" onclick="closeMoodHelpModal()">‚ùå</button>
            <h3>Why track your mood?</h3>
            <div class="mood-help-text">
                <p>It might seem cheesy, but it's often the only reason you realize why the day felt hard‚Äîor how you got through it.</p>
                
                <div class="mood-help-visual">
                    <div class="help-battery-example">
                        <div class="help-battery-label">Your energy today:</div>
                        <div class="help-battery-gauge">
                            <div class="help-battery-body">
                                <div class="help-battery-bar empty"></div>
                                <div class="help-battery-bar empty"></div>
                                <div class="help-battery-bar empty"></div>
                                <div class="help-battery-bar filled mood-tired"></div>
                                <div class="help-battery-bar filled mood-tired"></div>
                            </div>
                            <div class="help-battery-tip"></div>
                        </div>
                        <div class="help-battery-status">Tired (2/5) - Maybe take it easy today</div>
                    </div>
                </div>

                <div class="mood-help-benefits">
                    <div class="benefit-item">
                        <strong>It connects the dots.</strong><br>
                        What looks like laziness might've been quiet panic. Mood check-ins help you catch what's really going on, before the self-blame sets in.
                    </div>
                    
                    <div class="benefit-item">
                        <strong>It softens the story.</strong><br>
                        You start to notice: "Oh, that was just a heavy day." Not "something's wrong with me."
                    </div>
                    
                    <div class="benefit-item">
                        <strong>It reveals odd little patterns.</strong><br>
                        Maybe Tuesdays always drain you. Maybe things go smoother after yelling into a pillow and drinking orange juice. (Relatable.)
                    </div>
                    
                    <div class="benefit-item">
                        <strong>It makes planning less fake.</strong><br>
                        Some tasks seem small but feel huge. Tracking helps you stop pretending they're easy‚Äîand plan around their real weight.
                    </div>
                    
                    <div class="benefit-item">
                        <strong>It helps you feel what you're actually feeling.</strong><br>
                        When executive dysfunction kicks in, everything can feel foggy or numb‚Äîlike your emotions are on mute. A quick mood check-in helps you tune back in, so you can name what's going on instead of just feeling stuck.
                    </div>
                    
                    <div class="benefit-item">
                        <strong>And it counts.</strong><br>
                        Even when you can't do much else‚Äîthis counts. Five seconds to check in might be what unlocks the next five minutes.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Past Moods Modal -->
    <div class="modal unified-modal" id="pastMoodsModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closePastMoodsModal()">‚ùå</button>
            <h3>Past Moods</h3>
            <div id="pastMoodsContent" class="mood-timeline"></div>
        </div>
    </div>

    <!-- Trends Modal -->
    <div class="modal unified-modal" id="trendsModal">
        <div class="modal-content trends-modal-content">
            <button class="modal-close" onclick="closeTrendsModal()">‚ùå</button>
            <h3>üìà Your Mood Journey</h3>
            <div class="trends-content">
                <div class="trends-period">
                    <h4>This Week</h4>
                    <div id="weeklyTrends" class="weekly-trends"></div>
                </div>
                <div class="trends-insight" id="trendsInsight">
                    <div class="insight-icon">üí°</div>
                    <div class="insight-text">Analyzing your mood patterns...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Energy Insights Modal -->
    <div class="modal unified-modal" id="energyModal">
        <div class="modal-content energy-modal-content">
            <button class="modal-close" onclick="closeEnergyModal()">‚ùå</button>
            <h3>‚ö° Your Energy Insights</h3>
            <div class="energy-content">
                <div class="energy-breakdown">
                    <h4>üîã Energy Distribution</h4>
                    <div id="energyChart" class="energy-chart"></div>
                </div>
                <div class="energy-times">
                    <h4>‚è∞ Peak Energy Times</h4>
                    <div id="energyTimes" class="energy-times-chart"></div>
                </div>
                <div class="energy-insight" id="energyInsightText">
                    <div class="insight-icon">üí≠</div>
                    <div class="insight-text">Discovering your energy patterns...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>
</html>
